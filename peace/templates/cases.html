{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KDPP – Reported Cases</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family:"Poppins",sans-serif; background:#f7f7f7; margin:0; padding:0; }

/* NAVBAR */
nav { display:flex; justify-content:space-between; align-items:center; padding:18px 50px; background:#002533; }
nav h1 { color:white; font-size:28px; margin:0; }
nav ul { display:flex; list-style:none; margin:0; padding:0; gap:25px; }
nav ul li a { color:white; text-decoration:none; }
nav ul li a:hover { color:#4ec3ff; }

/* LANGUAGE SELECTOR */
.language-selector { text-align:center; margin:20px 0; }
.language-selector select { padding:8px 12px; border-radius:6px; border:1px solid #ccc; font-size:1rem; cursor:pointer; }

/* CASE GRID */
.cases-section { padding:60px 20px; max-width:1200px; margin:auto; }
.section-title { text-align:center; font-size:2rem; margin-bottom:35px; color:#333; }
.cases-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(270px,1fr)); gap:25px; }
.case-card { background:white; padding:25px; border-radius:14px; box-shadow:0 6px 20px rgba(0,0,0,0.1); transition:transform 0.3s; }
.case-card:hover { transform:translateY(-10px); }
.case-card h3 { margin-top:0; font-size:1.4rem; color:#007bff; }
.case-card .location, .case-card .date { font-size:0.95rem; color:#444; }
.case-card .desc { margin:10px 0; color:#555; }
.status { padding:6px 12px; border-radius:8px; font-size:0.8rem; font-weight:bold; color:white; }
.status.HIGH { background:#dc3545; }
.status.MEDIUM { background:#ffc107; }
.status.LOW { background:#28a745; }

/* FILTERS */
.filters { text-align:center; margin-bottom:25px; }
.filters select { padding:6px 12px; margin:0 5px; border-radius:6px; border:1px solid #ccc; }
.filters button { padding:6px 14px; border:none; border-radius:6px; background:#007bff; color:white; cursor:pointer; }
.filters button:hover { background:#0056b3; }

/* PAGINATION */
.pagination { display:flex; justify-content:center; margin-top:30px; gap:8px; }
.pagination a, .pagination span { padding:8px 14px; border-radius:6px; border:1px solid #ddd; color:#007bff; text-decoration:none; }
.pagination .current { background:#007bff; color:white; border-color:#007bff; }

/* FOOTER */
footer { background:#002533; color:white; text-align:center; padding:18px 0; margin-top:50px; }
footer a { color:#4ec3ff; text-decoration:none; margin:0 8px; }
footer a:hover { text-decoration:underline; }
</style>
</head>
<body>

<!-- NAVBAR -->
<nav>
<h1>KDPP</h1>
<ul>
    <li><a href="{% url 'index' %}">Home</a></li>
    <li><a href="{% url 'about' %}">About</a></li>
    <li><a href="{% url 'report' %}">Report Conflict</a></li>
    <li><a href="{% url 'cases' %}">Cases</a></li>
    <li><a href="{% url 'contact' %}">Contact</a></li>
</ul>
</nav>

<!-- LANGUAGE SELECTOR -->
<div class="language-selector">
    <label for="language" style="font-weight:bold; font-size:1.1rem; margin-right:10px;">Choose Language / Chagua Lugha:</label>
    <select id="language" name="language">
        <option value="en">English</option>
        <option value="sw">Swahili / Kiswahili</option>
        <option value="ki">Kikuyu / Gikuyu</option>
        <option value="luo">Luo / Dholuo</option>
        <option value="luya">Luhya / Luhya</option>
        <option value="kamba">Kamba / Kikamba</option>
        <option value="meru">Meru / Kimeru</option>
        <option value="maasai">Maasai / Maa</option>
        <option value="somali">Somali / Af Soomaali</option>
        <option value="other">Other / Lingua nyingine</option>
    </select>
</div>

<!-- CASES SECTION -->
<section class="cases-section">
    <h2 class="section-title">Latest Reports</h2>

    <div class="filters">
        <form method="get">
            <select name="severity">
                <option value="">All Severities</option>
                <option value="HIGH" {% if selected_severity == "HIGH" %}selected{% endif %}>HIGH</option>
                <option value="MEDIUM" {% if selected_severity == "MEDIUM" %}selected{% endif %}>MEDIUM</option>
                <option value="LOW" {% if selected_severity == "LOW" %}selected{% endif %}>LOW</option>
            </select>
            <select name="region">
                <option value="">All Regions</option>
                {% for r in regions %}
                <option value="{{ r }}" {% if selected_region == r %}selected{% endif %}>{{ r }}</option>
                {% endfor %}
            </select>
            <select name="county">
                <option value="">All Counties</option>
                {% for c in counties %}
                <option value="{{ c }}" {% if selected_county == c %}selected{% endif %}>{{ c }}</option>
                {% endfor %}
            </select>
            <button type="submit">Filter</button>
        </form>
    </div>

    <div class="cases-grid">
        {% if page_obj %}
            {% for report in page_obj %}
            <div class="case-card">
                <h3>{{ report.case_type }}</h3>
                <p class="location">Region: {{ report.region }}, County: {{ report.county }}</p>
                <p class="date">Submitted: {{ report.date_submitted|date:"M d, Y H:i" }}</p>
                <p class="desc">{{ report.description|truncatechars:120 }}</p>
                {% if report.image %}
                <p><a href="{{ report.image.url }}" target="_blank">View Evidence</a></p>
                {% endif %}
                <span class="status {{ report.severity|default:'LOW' }}">{{ report.severity|default:'LOW' }}</span>
            </div>
            {% endfor %}
        {% else %}
            <p>No reports found.</p>
        {% endif %}
    </div>

    <!-- PAGINATION -->
    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}{% if selected_severity %}&severity={{ selected_severity }}{% endif %}{% if selected_region %}&region={{ selected_region }}{% endif %}{% if selected_county %}&county={{ selected_county }}{% endif %}">Prev</a>
        {% endif %}
        <span class="current">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}{% if selected_severity %}&severity={{ selected_severity }}{% endif %}{% if selected_region %}&region={{ selected_region }}{% endif %}{% if selected_county %}&county={{ selected_county }}{% endif %}">Next</a>
        {% endif %}
    </div>
</section>

<!-- FOOTER -->
<footer>
    <p>© 2025 Kenya Digital Peace Platform — All Rights Reserved</p>
    <p>
        <a href="{% url 'index' %}">Home</a> |
        <a href="{% url 'about' %}">About</a> |
        <a href="{% url 'report' %}">Report</a> |
        <a href="{% url 'cases' %}">Cases</a> |
        <a href="{% url 'contact' %}">Contact</a>
    </p>
    <p>Committed to transparency, safety, and community unity across Kenya.</p>
</footer>

</body>
</html>
